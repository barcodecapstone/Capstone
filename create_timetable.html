<html>
<head>
	<title>Creating Timetable</title>
	<link rel="stylesheet" href="css/bootstrap.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<script src="js/jquery.js"></script>
	<script src="js/bootstrap.js"></script>
	<link href="https://fonts.googleapis.com/css?family=Yatra+One" rel="stylesheet">
	

	<!-----------------SCRIPT FOR CONNECTING FIREBASE------------------------->
	<script src="https://www.gstatic.com/firebasejs/5.4.2/firebase.js"></script>
	<script>
	  // Initialize Firebase
	  var config = {
	    apiKey: "AIzaSyAsDnXD02GeLCn59Wx2CgQqOwRqQo0_J7Q",
	    authDomain: "barcoder-c2af4.firebaseapp.com",
	    databaseURL: "https://barcoder-c2af4.firebaseio.com",
	    projectId: "barcoder-c2af4",
	    storageBucket: "barcoder-c2af4.appspot.com",
	    messagingSenderId: "88188653581"
	  };
	  firebase.initializeApp(config);
	</script>
	<!-----------------SCRIPT FOR CONNECTING FIREBASE------------------------->

	<script>

		function section_fetch()
		{
			var table=document.getElementById("courses_table");
			var table_size=table.rows.length-1;
			if(table_size!=0)
			{
				for(var i = table. rows. length - 1; i > 0; i--)
					{
						table. deleteRow(i);
					}
			}
    		//console.log("table length: "+table_size);
			var x = document.getElementById("department_section");
			while(x.length > 1)   
			{
			    x.remove(x.length-1);  //removing previously fetched items
			}
			var option = document.createElement("option");
			// option.text = "Kiwi";
			// x.add(option);	
			var selected_section=document.getElementById("department_list").value;
			//console.log(selected_section);
			var databaseRef=firebase.database().ref('sections/'+selected_section+"/");
			databaseRef.once('value', function(snapshot) 
			{
				snapshot.forEach(function(childSnapshot) 
				{
				    var childKey = childSnapshot.key;
	   				var childData = childSnapshot.val();
	   				var option2 = document.createElement("option");
					option2.text = childKey;
					x.add(option2);	
				});
			});
		}
		
		function add_department()
		{
			var x = document.getElementById("department_list");
			var option = document.createElement("option");
			// option.text = "Kiwi";
			// x.add(option);	

			var databaseRef=firebase.database().ref('sections/');
			databaseRef.once('value', function(snapshot) 
			{
				snapshot.forEach(function(childSnapshot) 
				{
				    var childKey = childSnapshot.key;
	   				var childData = childSnapshot.val();
	   				var option2 = document.createElement("option");
					option2.text = childKey;
					option2.value = childKey;
					x.add(option2);	
				});
			});
		}
		
		function fetch_year()
		{
			var x = document.getElementById("department_year");
			var table=document.getElementById("courses_table");
			var table_size=table.rows.length-1;
			if(table_size!=0)
			{
				for(var i = table. rows. length - 1; i > 0; i--)
					{
						table. deleteRow(i);
					}
			}
    		//console.log("table length: "+table_size);

			while(x.length > 1)   
			{
			    x.remove(x.length-1);  //removing previously fetched items
			}
			var option = document.createElement("option");
			// option.text = "Kiwi";
			// x.add(option);	
			var selected_dept=document.getElementById("department_list").value;
			//console.log(selected_section);
			var databaseRef=firebase.database().ref('courses/'+selected_dept+"/");
			databaseRef.once('value', function(snapshot) 
			{
				snapshot.forEach(function(childSnapshot) 
				{
				    var childKey = childSnapshot.key;
	   				var childData = childSnapshot.val();
	   				var option2 = document.createElement("option");
					option2.text = childKey;
					x.add(option2);	
				});
			});
		}

		function fetch_courses()
		{
			
    		var table = document.getElementById("courses_table");
    		var table_size=table.rows.length;
    		//console.log("table length: "+table_size);
    		var selected_course=document.getElementById('department_list').value;
    		var selected_year=document.getElementById('department_year').value;
			var databaseRef = firebase.database().ref('courses/'+selected_course+"/"+selected_year+"/");
			var rowIndex = 1;
			var rowsCount=0;
			var no_of_rows=1;
			databaseRef.on('value', function(snapshot) 
			{
				snapshot.forEach(function(childSnapshot) 
				{
				   var childData = childSnapshot.val();
				   var childKey = childSnapshot.key;
				   
				   var row = table.insertRow(rowIndex);
				   var cellId = row.insertCell(0);
				   var cellName=row.insertCell(1);
				   cellId.innerHTML=childKey;
				   cellName.innerHTML=childData;
				   
				   no_of_rows++;
				   rowIndex = rowIndex + 1;
				   
				   rowsCount++;
				});
				rowIndex=1;
			});
			console.log(no_of_rows+" these are no of rows");
			
		}
		function clear_table()
		{
			var table=document.getElementById("courses_table");
			var table_size=table.rows.length-1;
			if(table_size!=0)
			{
				for(var i = table. rows. length - 1; i > 0; i--)
					{
						table. deleteRow(i);
					}
			}
		}
	</script>
</head>
<body onload="add_department();">
	<div style="margin-left: 20px; margin-right: 20px; margin-top: 20px">
		<div class="col-md-4">
			<form>
				<div class="form-group">
					<label>Department</label>
					<select class="form-control" id="department_list" onchange="section_fetch();">
						<option>Select Department</option>
					</select>
				</div>
			</form>
		</div>
		<div class="col-md-4">
			<label>Section</label>
			<select class="form-control" id="department_section" onchange="fetch_year();">
				<option>Select Section</option>
			</select>
		</div>
		<div class="col-md-4">
			<form>
				<div class="form-group">
					<label>Year</label>
					<select class="form-control" id="department_year" onchange="clear_table();">
						<option>Select Year</option>
					</select>	
				</div>
			</form>
		</div>
		<button class="btn btn-success btn-block" onclick="fetch_courses();">Fetch Details</button>
		<div class="col-md-2">
			<table class="table table-bordered table-striped" id="courses_table">
				<thead>
					<tr>
						<th>Course Code</th>
					   <th>Course Name</th>
					</tr>
				</thead>
			</table>
		</div>
		<div class="col-md-8" >
			<table class="table table-bordered">
				<tr>
					<td></td>
					<td>9-10</td>
					<td>10-11</td>
					<td>11-12</td>
					<td>12-1</td>
					<td>1-2</td>
					<td>2-3</td>
					<td>3-4</td>
					<td>4-5</td>
				</tr>
				<tr>
					<td>Monday</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
				</tr>
				<tr>
					<td>Tuesday</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					
				</tr>
				<tr>
					<td>Thursday</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					
				</tr>
				<tr>
					<td>Wednesday</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					
				</tr>
				<tr>
					<td>Thursday</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					<td>
						<input type="text" placeholder="Subject" class="form-control">
						<input type="text" placeholder="Faculty" class="form-control">
					</td>
					
				</tr>
			</table>
		</div>
		<div class="col-md-2">
			<table class="table table-striped table-bordered">
				<tr>
					<th>Course Code</th>
					<th>Faculty Name</th>
				</tr>
				<tr>
					<th>l1</th>
					<th>Chinmay</th>
				</tr>
				<tr>
					<th>l2</th>
					<th>Chinmay2</th>
				</tr>
				<tr>
					<th>L3</th>
					<th>Chinmay3</th>
				</tr>
				<tr>
					<th>S1</th>
					<th>Chinmay</th>
				</tr>
			</table>
		</div>
	</div>
</body>
</html>